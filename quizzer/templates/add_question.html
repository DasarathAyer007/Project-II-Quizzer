{%extends 'base.html'%} {%block title%}Add Question{%endblock%} {%block content%}

<main class="w-full h-fit flex justify-center bg-base-b relative">




    <div class="w-full max-w-4xl mt-5 bg-white rounded-xl shadow-lg p-8 border border-gray-200 relative">
        <h1 class=" text-3xl font-bold mb-3 text-gray-800">Add Question</h1>
        <hr class="mb-3" />
        <form action="{{url_for('question.add_question')}}" method="post">
            {{ form.hidden_tag() }}
            <div class="mb-6 relative">
                {{form.question_text.label (class="block text-lg font-semibold mb-2")}}
                {{form.question_text ( id="question_text",  placeholder="Add your question" ,
                maxlength="100",
                class="w-full px-4 py-3 border border-gray-300 rounded-md placeholder:text-gray-400 placeholder:text-lg
                focus:outline-none focus:ring-2 focus:ring-blue-400"
                )}}
                <span id="charCounter" class="absolute right-0 bottom-0 text-sm mr-0.5 text-gray-400 ">0/100</span>
                
                {% for error in form.question_text.errors %}
                 <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>


            <div class="mb-6">
                <label class="block text-lg font-semibold mb-2">Options</label>
               
               
                <div class="grid grid-cols-2 gap-4">
                    {{form.option_1 (placeholder="Option 1", 
                    class="option-input px-4 py-2 border border-gray-300 rounded-md placeholder:text-base
                    focus:outline-none focus:ring-2 focus:ring-blue-400" )}}
                    {{form.option_2 (placeholder="Option 1" ,
                    class="option-input px-4 py-2 border border-gray-300 rounded-md placeholder:text-base
                    focus:outline-none focus:ring-2 focus:ring-blue-400" )}}
                    {{form.option_3 (placeholder="Option 1", 
                    class="option-input px-4 py-2 border border-gray-300 rounded-md placeholder:text-base
                    focus:outline-none focus:ring-2 focus:ring-blue-400" )}}
                    {{form.option_4 (placeholder="Option 1", 
                    class="option-input px-4 py-2 border border-gray-300 rounded-md placeholder:text-base
                    focus:outline-none focus:ring-2 focus:ring-blue-400" )}}
                </div>
                {% for error in form.correct_option.errors %}
                    <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <div class="mb-6 flex gap-6">
                <div class="flex-1">
                    {{form.correct_option.label (class="block text-lg font-semibold mb-2")}}
            
                    <select id="correctOption" name="correct_option" required
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400">
                        <option value="" disabled selected>Select Correct Option</option>
                    </select>
                 
                </div>


                <div class="flex-1">
                    {{form.category.label (class="block text-lg font-semibold mb-2")}}
                    {{form.category
                    (class="w-full px-4 py-2 border border-gray-300 rounded-md text-base text-gray-600
                    focus:outline-none focus:ring-2 focus:ring-blue-400"
                    )}}
                     {% for error in form.category.errors %}
                    <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                {% endfor %}
                </div>
            </div>


            <div class="text-center">
                {{form.submit
                    (class="bg-accent text-white font-semibold px-6 py-2 rounded-md hover:bg-blue-700 transition-all cursor-pointer" )}}
            </div>
        </form>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
   <div id="flash-overlay" class="absolute inset-0 bg-black/30 flex items-center justify-center z-50 transition-opacity duration-300">

      {% for category, message in messages %}
        <div class="rounded-xl px-8 py-6 shadow-2xl max-w-md w-full text-center
          {% if category == 'success' %}
            bg-green-100 text-green-800 border border-green-300
          {% elif category == 'error' %}
            bg-red-100 text-red-800 border border-red-300
          {% elif category == 'warning' %}
            bg-yellow-100 text-yellow-800 border border-yellow-300
          {% else %}
            bg-blue-100 text-blue-800 border border-blue-300
          {% endif %}">

          <p class="text-lg font-semibold">{{ message }}</p>

          {% if category == 'success' %}
            <p class="text-sm mt-1 text-green-700">Thank you for your support!</p>
          {% endif %}

          <button onclick="document.getElementById('flash-overlay').remove()"
                  class="mt-4 px-5 py-2 bg-white border border-gray-300 text-gray-700 hover:bg-gray-100 text-sm rounded-md transition">
            OK
          </button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}
    </div>





</main>


<script>

    const optionInputs = document.querySelectorAll(".option-input");
    const correctOptionSelect = document.getElementById("correctOption");

  
    document.addEventListener("DOMContentLoaded", () => {
    updateDropdown();
    optionInputs.forEach(input => {
        input.addEventListener("input", updateDropdown);
    });
});

    function updateDropdown() {
        correctOptionSelect.innerHTML = '<option value="" disabled selected>Select Correct Option</option>';

        optionInputs.forEach(input => {
            if (input.value.trim() !== "") {
                const option = document.createElement("option");
                option.value = input.value;
                option.textContent = input.value;
                correctOptionSelect.appendChild(option);
            }
        });
    }


    const input = document.getElementById('question_text');
    const counter = document.getElementById('charCounter');

    input.addEventListener("input", () => {
        const inputLength = input.value.length;
        const max = input.maxLength;

        counter.textContent = `${inputLength} / ${max}`;
    })

</script>

{%endblock%} {% block scripts %}
<!-- Child templates can insert their own scripts here -->
{% endblock %}